
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Charles Hooper</title>
  <meta name="author" content="Charles Hooper">

  
  <meta name="description" content="NESIT, a Connecticut hackerspace, was burglarized Sunday morning between 3:00am and 4:30am and is offering a $500 reward for information leading to &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://www.charleshooper.net/blog/page/4">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="http://feeds.feedburner.com/subversity" rel="alternate" title="Charles Hooper" type="application/atom+xml">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="./javascripts/lib/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-12888528-1']);
    _gaq.push(['_trackPageview']);

    setTimeout("_gaq.push(['_trackEvent', '60_seconds', 'read'])", 60000);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>



</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">Charles Hooper</a></h1>
  
    <h2>Thoughts and projects from a Hacker and Engineering Manager</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="http://feeds.feedburner.com/subversity" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="http://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:www.charleshooper.net" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">Blog</a></li>
	<li><a href="/about/">About Charles</a></li>
	<li><a href="/projects/">Projects</a></li>
	<li><a href="/contact/">Contact</a></li>
  <li><a href="/blog/archives">Archives</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div class="blog-index">
  
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/nesit-hackerspace-break-in/">NESIT Hackerspace Break-In</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2011-04-23T00:00:00-07:00" pubdate data-updated="true">Apr 23<span>rd</span>, 2011</time>
        
      </p>
    
  </header>


  <div class="entry-content"><h1 id="section"></h1>

<p><a href="http://www.nesit.net/">NESIT, a Connecticut hackerspace</a>, was burglarized Sunday morning between 3:00am and 4:30am and is offering a $500 reward for information leading to the arrest of the burglar. They have released some of their security footage from the burglary. They ask that anyone who recognizes the burglar or has information call them at 1-203-51-HACKS (1-203-514-2257).</p>

<p>Within the first 10 seconds, you see what appears to be a camera in the hallway get covered up by something from behind. Afterwards, you can see someone calmly walking around the inside of the hackerspace for the next hour and a half with a headlamp on. The headlamp turns out to be pretty beneficial for NESIT, because as a Facebook commentator pointed out, you can see that the burglar is roughly as tall as one of the shelves in the space.</p>

<p>What I found most interesting, however, is that around 8 minutes and 30 seconds into the footage you get a pretty nice shot of… cleavage? No, I’m not being a jokester. It *appeared *to me that the burglar was wearing a low-cut shirt with some type of line up the middle. It looked like cleavage to me and the second opinion of my girlfriend, but NESIT believes that this was actually a shirt that was wrapped around the burglar’s head. <strong>UPDATE</strong>: After a second, closer look at the surveillance footage, I agree with NESIT.</p>

<p>Despite the security footage being black and white and fairly low in quality, it tells us quite a bit.</p>

<ul>
  <li>The burglar was familiar enough with the location to know about the hallway surveillance camera.</li>
  <li>The burglar was <em>not</em> familiar enough to know about the other cameras inside the hackerspace.</li>
  <li>The burglar was comfortable enough to spend **an hour and a half **walking around and looking through boxes and drawers.</li>
  <li>The burglar’s height is roughly as tall as one of the shelves in the hackerspace. <strong>UPDATE</strong>: I’m told that the height is between 6’0″ and 6’2″.</li>
  <li>The burglar has enough strength to pry off the lock on the door and part of the concrete wall.</li>
</ul>

<p>I sure hope they catch the bad guy.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/automating-webcam-snapshots-and-uploads-to-flickr/">Automating Webcam Snapshots and Uploads to Flickr</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2011-03-26T00:00:00-07:00" pubdate data-updated="true">Mar 26<span>th</span>, 2011</time>
        
      </p>
    
  </header>


  <div class="entry-content"><h1 id="section"></h1>

<p>With gardening season right around the corner, one of my desires was to set something up that would allow me to take automated, regular snapshots of some of my plants and upload them to flickr. After a few cumulative hours I finally cobbled together the solution.</p>

<h2 id="taking-the-snapshots">Taking the Snapshots</h2>

<p>The first thing I needed to do was to take snapshots from an installed USB webcam and save them to a directory. This needed to be able to run from a cron script so obviously it needed to work without a GUI and without user-interaction. I read in a <a href="http://www.tldp.org/HOWTO/html_single/Webcam-HOWTO/#COMMAND">Webcam Howto</a> that I could do this using <strong>streamer</strong> so I installed it and wrote a short shell script that would iterate through the video devices installed on my PC and run the snapshot command. You can <a href="https://bitbucket.org/hoop/snapshot/src/98aa5d9a2038/snapshot">view the source of this script here</a>.</p>

<h2 id="uploading-the-photos">Uploading the Photos</h2>

<p>Next I wanted to automatically upload the files to Flickr. At first, I tried using a script I found called uploadr.py which worked OK, but I also wanted to add my photos to a specific set which this script didn’t do. I probably could have extended its functionality, but this script didn’t use or implement the full Flickr API which made this task seem unnecessary.</p>

<p>Instead, I downloaded the <a href="http://stuvel.eu/flickrapi">Python Flickr API from Stuvel</a> and in less than 90 lines I had working code to upload a directory of images to Flickr and add them to a given set. You can view the source to my <a href="https://bitbucket.org/hoop/snapshot/src/98aa5d9a2038/simpleuploadr.py">flickr uploader script</a> here, which I’m calling <a href="https://bitbucket.org/hoop/snapshot">simpleuploadr.py</a> for now.</p>

<h2 id="results">Results</h2>

<p><a href="http://www.flickr.com/photos/hoop2w1/sets/72157626354700156/with/5620672632/">Here are my pretty pictures</a> :) My apologies for the quality, I’m using a really cheap webcam.</p>

</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/correlating-last-login-dates-with-signup-dates-from-a-mmorpg/">Correlating Last Login Dates With Signup Dates From a MMORPG</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2011-03-24T00:00:00-07:00" pubdate data-updated="true">Mar 24<span>th</span>, 2011</time>
        
      </p>
    
  </header>


  <div class="entry-content"><h1 id="section"></h1>

<p>Yesterday, I wrote a blog post detailing <a href="http://www.charleshooper.net/blog/screen-scraping-search-results-for-information-retrieval/">how I crawled an entire MMORPG’s player database via their search page</a>. Since then, I have been analyzing that data in Minitab and trying to gain some insight into the state of affairs of that game. Today, I’m going to attempt to explain some of that data using statistics and common sense. In particular, we’re going to find out if there’s a relationship between <em>when players join the game *and *when they stop returning</em>.</p>

<h2 id="preparation">Preparation</h2>

<p>I’m new to the statistics software package I’m using, Minitab, and I’m not aware of an easy way to take measurements based on dates. So, my first order of business was to convert dates in the database to an easier metric for analysis, “days since today,” which is simply <em>today’s date</em> minus <em>date x</em>. I did this in my database (MongoDB) prior to export by adding a “last_seen_days” attribute to all documents (records). This attribute is simply the difference between today’s date and the date that the player stopped logging in – measured in days. I then did the same for the signup date. This was quickly done in the MongoDB console in just a few lines:</p>

<pre><code>&gt; var today = new Date();
&gt; var day = 60*60*24*1000;
&gt; db.accounts.find().forEach(function (o) { o.last_seen_days = Math.ceil((today.getTime() - o.last_seen.getTime())/day); db.accounts.save(o); })
&gt; db.accounts.find().forEach(function (o) { o.date_joined_days = Math.ceil((today.getTime() - o.date_joined.getTime())/day); db.accounts.save(o); })
</code></pre>

<h2 id="the-scatterplot">The Scatterplot</h2>

<p>I then exported my data to CSV, loaded it in Minitab, and created a scatterplot between these two attributes. What I got was this:</p>

<p><img src="http://sub-public.s3.amazonaws.com/cch-i/blogimgs/last_seen_vs_signup.jpg" alt="Last Seen Date vs Signup Date" title="Last Seen Date vs Signup Date" /></p>

<p>For the uninitiated, a <strong>scatterplot **is a quick and easy way to visually see if there’s any type of relationship (correlation) between two variables. In this case, I used the signup date as my **independent variable</strong> (<em>x</em>) and the “last seen” date as my <strong>dependent variable</strong> (<em>y</em>). Overall, there is <em>not *any real relationship between the signup date and the last seen date. However</em>,* there are two significant items in this graph that deserve to have some attention brought to them.</p>

<h2 id="observations">Observations</h2>

<p>The first and most obvious item is that <strong>there are not any points above the identity function</strong>. The identity function, or just <em>f(x) = x</em>, is the diagonal line directly across the center of the graph. This makes perfect sense since it’s impossible for a player to have their “last login” occur before they even sign up. I bring this up because this leads into my next observation:</p>

<p><strong>There is a heavier concentration of data points plotted on or directly below the line of the identity function</strong>. For points exactly <em>on</em> the identity function, these are accounts that registered but were never logged into. For accounts *below *the identity function, these should be considered more significant to those who run the game. Why is that? Because, simply put, I believe that these accounts belong to players who went through the effort of joining; They signed up, validated their email address, logged in, and for whatever reason chose not to stick around. This is akin to the “<strong>bounce rate</strong>” so frequently mentioned in the context of web analytics.</p>

<p>It’s possible that these new players didn’t  understand the interface and left, or maybe they thought the game play was too slow, or maybe… this list could go on. What’s important is that some attention is paid here. Some effort should be made to discover why these players are leaving and the number of these players (or almost-players) should be measured, monitored, and analyzed. Decreasing this metric (“bounce rate”) should be a regular goal as these players represent a potential revenue stream for the game’s owner as well as a potential contribution to the game for the rest of the players.</p>

<h2 id="the-histogram">The Histogram</h2>

<p>While, in this case, the scatterplot helped us see that there are a noticeable amount of players who quickly “bounce” after joining the game, this type of graph doesn’t make it particularly easy to measure the magnitude of this phenomena. From observing this behavior, we next want to know how many players are leaving, or what our “bounce rate” is. Instead of first trying to quantitatively define the bounce rate so that we can measure it, it’s probably best if we first take a look at the total distribution of how long players are active for before leaving. For this, we’ll use the histogram of “Days Active”. <em>Days active</em> is simply <em>days since signup</em> minus <em>days since last login</em>.Here’s what we’ve got:</p>

<p><img src="http://sub-public.s3.amazonaws.com/cch-i/blogimgs/days_active_hist.jpg" alt="" title="Histogram of Days Active (excl. lowest-ranked accounts)" /></p>

<p>In this histogram, I excluded the lowest rank from being included in the histogram. I did this because I was more interested in how many potentially-active players were leaving, as opposed to junk accounts. As such, our definition of the <em>bounce rate</em> is already becoming more different than the bounce rate in web analytics.</p>

<p>Each bin (“bar”) in our histogram is 15 days wide. Knowing this, you can see from the histogram that the largest density of days active seems to be about from 15 days to 2.5 months. This chunk, while significant, doesn’t have much to do with our bounce rate mentioned above. What we’re instead interested in is the near-5% of players who become inactive in less than a week.</p>

<h2 id="whats-next">What’s Next?</h2>

<p>If this were my game (it’s not), I would work on defining what level of bounce rate is acceptable and set some goals based on that. I would then look into the large amount of players leaving within the first 2.5 months and try to increase player retention. Finally, I would automate these measurements and have them displaced in a nice administrative dashboard (I’ve always wanted one of those) so that I have to see them all the time.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/screen-scraping-search-results-for-information-retrieval/">Screen-Scraping Search Results for Information Retrieval</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2011-03-23T00:00:00-07:00" pubdate data-updated="true">Mar 23<span>rd</span>, 2011</time>
        
      </p>
    
  </header>


  <div class="entry-content"><h1 id="section"></h1>

<p>Recently I found myself in a situation where I needed to gather a large amount of data from a website but there did not exist any API, index, or otherwise publicly-accessible map of the data. In fact, the only mechanism for uncovering data to be collected was a very limited search engine.</p>

<p>In particular, I was trying to collect a list of (living, non-banned) usernames from a web-based RPG I play so I could then download, parse, and store their profiles for further analysis. I needed all of the data simply because there also was not any way in which I could get a truly random statistical sample.</p>

<p>The game’s search engine has these limitations and features:</p>

<ul>
  <li>Search is performed on username only and implicitly places a wildcard after the search. For example, if you search for “bob” not only will “bob” be returned in the results, but also “bob123″ and “bobafett,”</li>
  <li>If a given search returns more than 35 results than only the first 35 results are returned,</li>
  <li>Results are sorted by username (alphabetically),</li>
  <li>Usernames are case-insensitive and can only contain alphanumeric characters, i.e. {ABCDEFGHIJKLMNOPQRSTUVWXYZ1234567890},</li>
  <li>Search queries cannot start with the character zero (“0″), but I happily overlook this,</li>
  <li>The search engine does allow you to filter out players who have been killed or banned.</li>
</ul>

<p>So, there I was, trying to crawl this game’s search feature using urllib and regular expressions. I first tried to search for “A”, then “B”, then ”C”, and so on, but there were some obvious flaws with this method. In particular, because of the limit on the number of results that can be returned, this method would only yield 1,260 usernames. This isn’t good enough because I knew from the game’s statistics page that I should be expecting a little more than 21,000 names!</p>

<p>The logical extension of that search method is to tack on an extra letter. For example, try “AA”, then, “AB”, then “AC”, all the way down to “ZZ” (or, erm, “99″ on this case). This seems alot better because, hypothetically, the keyspace is large enough to return more than twice as many usernames than what I need – I believe the math is (36^2)*35 or 45,360 usernames.</p>

<p>Unfortunately, this  method falls apart very quickly because there isn’t an even distribution of usernames across the keyspace. I could try to go one level deeper on the searches (e.g., “AAA” to “AAB”, and so forth) but now we’re looking at 36^3 or 46,656 search pages I have to crawl, so this method is out of the question.</p>

<p>Making matters worse, I am completely naive as to what the distribution of usernames might actually look like.I know what it looks like <em>now</em>, but moving forward I had absolutely no idea what to expect. (Just in case you’re curious, you can see the actual distribution – sans accounts that start with “0″ – below.)</p>

<p><img src="http://sub-public.s3.amazonaws.com/cch-i/blogimgs/letter_freq_dist.png" alt="Account Distribution by First Character" title="Account Distribution by First Character" /></p>

<p>I decided, then, that I would start with “A” to “Z” to “1″ to “9″ and dynamically and recursively expand one level deeper if only 35 results were returned from the search. <a href="https://bitbucket.org/hoop/bootcrawl/src/9a3714a9e24e/crawl.py">You can see this dynamic, search unfolding code here on Bitbucket (Python, lines 46 through 65)</a>.</p>

<p>The results were pretty positive. I crawled almost the entire set of alive, unbanned accounts in just over 2 hours (while I played video games and drank beer). I missed exactly 356 accounts, or about 1.6% of the population. While some of these may have been accounts that started with the character “0″ (remember, I couldn’t crawl those,) it seems more likely that many of these were aborted HTTP requests that failed and were handled by my ridiculous try/except:pass block.</p>

<p>Now that I have this data, it’s time for me to do something with it. You’ll hear more about that from me soon, I’m sure.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/cost-behavior-analyzer-update-edit-functionality/">Update to Cost Behavior Analyzer</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2011-02-09T00:00:00-08:00" pubdate data-updated="true">Feb 9<span>th</span>, 2011</time>
        
      </p>
    
  </header>


  <div class="entry-content"><h1 id="section"></h1>

<p>I just updated my <a href="http://apps.charleshooper.net/cost-behavior-analysis/">Cost Behavior Analyzer</a> webapp to allow for the editing of results. This way, if you want to add new data points at a later point in time, it’s no problem. Try it out!</p>

</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/multiple-vulnerabilities-in-mingle-forum-wordpress-plugin/">Multiple Vulnerabilities in Mingle Forum (WordPress Plugin)</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2011-01-08T00:00:00-08:00" pubdate data-updated="true">Jan 8<span>th</span>, 2011</time>
        
      </p>
    
  </header>


  <div class="entry-content"><h1 id="section"></h1>

<p>Title: Multiple Vulnerabilities in Mingle Forum (WordPress Plugin)<br />
Advisory URL: http://www.charleshooper.net/blog/multiple-vulnerabilities-in-mingle-forum-wordpress-plugin/<br />
Date Published: January 8th, 2011<br />
Vendors Contacted: Paul Carter – Maintainer of plugin.</p>

<ol>
  <li>Summary</li>
</ol>

<p>Mingle Forum is a plugin for the popular blog tool and publishing<br />
platform, WordPress. According to the author of Mingle Forum, “Mingle<br />
Forum has been modified to be lightweight, solid, secure, quick to<br />
setup, and easy to use.”</p>

<p>There exist multiple vulnerabilities in Mingle Forum, SQL injection<br />
being among them.</p>

<ol>
  <li>Vulnerability Information</li>
</ol>

<p>Packages/Versions Affected: Confirmed on 1.0.24 and 1.0.26</p>

<p>3a. Type: SQL Injection [CWE-89]<br />
3a. Impact: Read application data.<br />
3a. Discussion: There is a SQL injection vulnerability present in the<br />
RSS feed generator. By crafting specific URLs an attacker can retrieve<br />
information from the MySQL database.</p>

<p>3b. Type: SQL Injection [CWE-89]<br />
3b. Impact: Read application data.<br />
3b. Discussion: There is a SQL injection vulnerability present in the<br />
`edit post` functionality. By crafting specific URLs an attacker can<br />
retrieve information from the MySQL database.</p>

<p>3c. Type: Auth Bypass via Direct Request [CWE-425]<br />
3c. Impact: AuthZ is not performed for `edit post` functionality.<br />
3c. Discussion: By browsing directly to the `edit post` page a user can<br />
view and edit any page.</p>

<ol>
  <li>PoC &amp; Technical Description</li>
</ol>

<p>4a.<br />
<a href="http://path.to/wordpress/wp-content/plugins/mingle-forum/feed.php?topic=0 UNION SELECT 1,user_email,3,4,5,user_login,7 FROM wp_users #">http://path.to/wordpress/wp-content/plugins/mingle-forum/feed.php?topic=0 UNION SELECT 1,user_email,3,4,5,user_login,7 FROM wp_users #</a></p>

<p>4b.  </p>

<p>4c. </p>

<ol>
  <li>Report Timeline</li>
</ol>

<p>12/17/2010 Initial email sent to plugin maintainer.<br />
12/22/2010 Confirmation of first email requested.<br />
12/31/2010 Correct email address obtained. Maintainer contacted again on<br />
this date.<br />
01/01/2011 Received response from plugin maintainer.<br />
01/07/2011 Plugin maintainer releases update that addresses these<br />
vulnerabilities.</p>

<ol>
  <li>References</li>
</ol>

<p>6a. The WordPress Plugin page for Mingle Forum:  </p>

<ol>
  <li>Legalese</li>
</ol>

<p>This vulnerability report by Charles Hooper &lt;  &gt; is<br />
licensed under a Creative Commons Attribution-NonCommercial-ShareAlike<br />
3.0 Unported License.</p>

<ol>
  <li>Signature</li>
</ol>

<p>Public Key: Obtainable via pool.sks-keyservers.net</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/picking-applications-to-audit/">Picking Applications to Audit</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2010-12-23T00:00:00-08:00" pubdate data-updated="true">Dec 23<span>rd</span>, 2010</time>
        
      </p>
    
  </header>


  <div class="entry-content"><h1 id="section"></h1>

<p>I’m sure almost any programmer will tell you that at some point they felt the need to work on a project but had no idea what to work on. This happens to me, too, even when it comes down to choosing what applications or services I want to audit. With practice, I’ve come up with a pretty good list of categories to choose software from and I would like to share them with you.</p>

<h2 id="applications-or-service-youuse">1. Applications or Service You Use</h2>

<p>This is probably to most obvious way to choose what application or service to audit. However, to me, it’s also one of the hardest. The reason why it is so difficult is because it involves breaking out of your mental “user” mode where you’re just <em>using</em> the application or service. I know that when *I’m *in “user” mode, I probably am not even fully conscious of the amount of software or services I use every day and how much I rely on them.</p>

<p>The solution, then, is to break out of “user” mode. Once out of “user” mode (and in “audit” or “attack” mode) everything becomes clearer. For example, I recently submitted a vulnerability to a pretty large service provider (I can’t say who yet); was the vulnerability in some back page or a piece of functionality that nobody uses? No, surprisingly, this vulnerability was part of a key piece of functionality that I actually <em>use</em> frequently.</p>

<h2 id="applications-or-services-thatyou-like-or-believe-in">2. Applications or Services That You “Like” or “Believe In”</h2>

<p>This is more of an extension than the item above, but it’s worth stressing. If there’s an application or service that you think has potential, go ahead and audit it. New applications and services are often full of low-hanging fruit. By auditing these and reporting the vulnerabilities, you are helping to make these applications and services better.</p>

<h2 id="applications-and-services-that-make-it-economically-beneficial-to-audit-them">3. Applications and Services That Make It “Economically Beneficial” to Audit Them</h2>

<p>This is a no-brainer. If you’re being offered money to audit an application or service (and the person offering the money has the authority to give you permission to do so,) then this is a pretty good place to start. Google, for example, has a <a href="http://googleonlinesecurity.blogspot.com/2010/11/rewarding-web-application-security.html">Vulnerability Rewards Program</a>.</p>

<h2 id="closing">Closing</h2>

<p>These are just three of the categories to look for applications or services to audit. It’s certainly not complete as there is a plethora of software out there waiting to be audited, but I hope that this gives you a good head start.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/so-you-just-received-a-vulnerability-report-now-what/">So You Just Received a Vulnerability Report. Now What?</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2010-12-22T00:00:00-08:00" pubdate data-updated="true">Dec 22<span>nd</span>, 2010</time>
        
      </p>
    
  </header>


  <div class="entry-content"><h1 id="section"></h1>

<p>It has come to my attention that there is still at least one group of people that doesn’t know <strong>how to responsibly deal with vulnerability reports</strong>. No, I’m not talking about the security researchers, the blackhats, or the script kiddies. It’s true that there is already alot of  controversy surrounding proper (or responsible) disclosure etiquette, but that doesn’t concern the group I’m referring to right now. I’m talking about the maintainer of the resource that the vulnerability report is for. That means you, project maintainers!</p>

<h2 id="before-receiving-a-report">Before Receiving a Report</h2>

<p>One of the biggest difficulties I’ve been having lately is finding contact information for a project maintainer or their security contact. On multi-developer projects, there should be at least one person who is responsible for fielding security-related reports that come in. They should have the ability to put fixes for security vulnerabilities on high priority for the developers.</p>

<p>Your “security guy’s” email should be easy to find or guess. For example, Google’s is security@google.com and this address is <a href="http://www.google.com/corporate/security.html">easy to find</a>. You could also achieve this effect by using support/bug report forums, but be sure that any bug or report marked as security-related should be automatically hidden from public view. Regardless of if you decide to use a dedicated email box/alias or support forums for your security reports,  it is most important to make <em>someone</em> responsible for making sure that security reports are reacted to quickly and professionally.</p>

<h2 id="after-receiving-a-report">After Receiving a Report</h2>

<p>As soon as the first human has eyes on the report, it should be assigned to an individual and a confirmation should be sent to the person who provided it. Here’s is one such confirmation:</p>

<blockquote>
  <p>Thank you for reporting this to us! We have opened a security
investigation to track this issue. The case number for your tracking
is MSRC [XXXX]. XXXX is the Security Program Manger assigned to the case and he will be working with you and the Microsoft.com team to investigate the issue. She will be following up with you shortly.</p>
</blockquote>

<p>This step is super important because many of the people who take the time to report vulnerabilities to the vendor are only just waiting to release the report to the public. You don’t want to still be working on the fix when the news of your project’s security flaw is released.</p>

<p>Once you have a someone assigned to the bug, have them send a brief introduction. I never received my introduction from “XXXX” above, so I sent another email inquiring on the status of the bug. Here is the response:</p>

<blockquote>
  <p>Thank you very much for your message! My name is YYYY and I have taken over this case from XXXX. Earlier this week, the online services team has started testing a fix for the original issue you have reported, and we are currently verifying this, which includes variation testing and a review of the whole page. The added details you have provided to us in the below message will certainly help us in this process, so thanks a lot!</p>

  <p>I will contact you as soon as the fix is deployed, and of course, if you have any further information or questions, please don’t hesitate to let us know.</p>
</blockquote>

<p>This email is short, brief, yet contains all the information I would ever want to know. In particular it includes:</p>

<ul>
  <li>An actual person I can continue to provide information to</li>
  <li>The status of the vulnerability/bug</li>
  <li>The next step(s) in their review process</li>
  <li>When I can expect to hear from them next</li>
</ul>

<p>Just like the MSRC said I would, I heard from them when the fix made it to production. (In case you were wondering, it was 5 calendar days later.) At this point, they made arrangements to acknowledge me on the “Security Researchers Acknowledgment” page. While this is certainly a nice perk, you don’t have to do this.</p>

<h3 id="a-valid-question-at-this-point-is-how-long-do-i-have-to-fix-this-vulnerability">A valid question at this point is “How long do I have to fix this vulnerability?”</h3>

<p>It depends, but as the vendor that’s up for you to figure out. If you’re receiving a vulnerability report from a non-public source, then consider yourself lucky. The person reporting the vulnerability likely believes in responsible disclosure (inherent of the fact that you got the report first) and will be willing to negotiate on the timeline. Be honest with this person. I once waited two months to report a minor SQL injection vulnerability in a trivial web application because the (sole) project maintainer was on vacation when I emailed him initially.</p>

<h2 id="summary-tldr">Summary (tl;dr)</h2>

<p>Many of the security researchers who will reach out to you believe in responsible (but full) disclosure. That means that your project’s security flaws <em>will</em> make it to the public sooner or later. To ensure the best experience for your users and the preservation of your project’s reputation, you need to handle your vulnerability reports quickly and properly. That means:</p>

<ul>
  <li>Making it easy to find out where to send vulnerability reports to</li>
  <li>Communicating with the source of the report to confirm receipt of their report</li>
  <li>Communicating with the source of the report your intentions for their report 
    <ul>
      <li>Who did the vulnerability get assigned to?</li>
      <li>What is the status of this vulnerability?</li>
      <li>What are the next steps in the review process for this vulnerability?</li>
      <li>When they can expect to hear from you next</li>
    </ul>
  </li>
  <li>Communicating with the source when you believe the vulnerability is fixed</li>
</ul>

<p>What is all boils down to is this: React quickly and keep open lines of communication between your project and the security researcher who took the time to report a vulnerability to you. If you do this, you’ll minimize the damage to your user base and your reputation.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/finding-web-vulnerabilities/">Finding Web Vulnerabilities</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2010-12-21T00:00:00-08:00" pubdate data-updated="true">Dec 21<span>st</span>, 2010</time>
        
      </p>
    
  </header>


  <div class="entry-content"><h1 id="section"></h1>

<p>At the <a href="http://www.nesit.net/">NESIT Hackathon</a> on Saturday, I was talking to a group of people about discovering web vulnerabilities and I was asked “Which scanner or tools do you use?” The absolute shortest answer I can provide is “I don’t use a scanner.” Despite the lack of a vuln scanner in my toolset, I am still able to consistently find vulnerabilities in web applications. Here’s how:</p>

<ol>
  <li>I first begin by <strong>finding or setting up an adequate test environment</strong>. If the project is freely available (aka open source/free software,) I set up a test environment. If the project is not freely available, then I look for a site that uses the platform or application I’m trying to audit. I don’t normally recommend the latter case, but if I’m testing a 3rd party web service then I don’t have any other choice.</li>
  <li>I then <strong>get familiar with the application</strong>. What does it do? What problem does it try to solve? What does a normal use case look like?</li>
  <li>Then I <strong>get really, <em>really</em> familiar with the application</strong>. In this stage, I’m really interested in the lesser-used functionality (such as error handling) and making things break. How does the application handle errors? How verbose are the error messages? Are any pages particularly slower than the others? Where does the application get most of its data? Request variables? Cookies? A database? A third party API?I usually do this step with the <a href="http://getfirebug.com/">Firebug plugin for Firefox</a>. I want to know exactly what parameters are being passed to the application, how those variables are being handled, and if (and how) those variables are being spit back out to the user.</li>
  <li>My secret weapon is not being afraid to <strong>look through the code</strong>, if it’s available. If the code is lengthy and I just want to take a cursory glance at it, I grep for “red flags.” Because most vulnerabilities are the result of unescaped, unsanitized user-input, these red flags are usually connected to user-provided variables. For example, If I’m auditing PHP scripts for vulnerabilities, I look for code referencing the $_GET, $_POST, $_REQUEST, and $_COOKIE variables. This step does wonders for finding Cross-Site Scripting and SQL injection vulnerabilities.</li>
  <li>In very small projects, like WordPress plugins, I’ll <strong>read through each</strong> <strong>file</strong> and try to figure out what story the code is telling. This is very much like reading a short story. I want to know what the application is <em>trying</em> to do.</li>
  <li>I’ll then <strong>read the code more in-depth</strong>. This is akin to analyzing poetry in a Literature class. Things like the actual names of variables and the syntax become much more important here. Now I want to know what the application is <em>actually</em> doing. 
I recently discovered Cross-Site Scripting SQL injection vulnerabilities in an URL field of an application that was <em>trying</em> to escape it’s input. The problem, however, was that the application was validating and sanitizing <em>$url_var</em> when the value of their user-input was <em>$var_url</em>. The combination of the lack of testing and the lack of error reporting allowed this bug to be introduced into production which created XSS and SQL injection vulnerabilities. Being able to read the code helps find other issues such as direct-request (authentication/authorization bypass) vulnerabilities.<br />
I can’t stress bug/vulnerability hunting outside the normal execution paths of any given application. If a blog platform seems pretty solid, try exploiting its dynamically-generated RSS feed. If a 3rd party web-service looks perfect, try exploiting its support forums or its help site in a different language or character set. <strong>Think outside of the box.</strong> That phrase is cliche, but it’s cliche for a reason.</li>
</ol>

</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/multiple-vulnerabilities-in-wp-forum-wordpress-plugin/">Multiple Vulnerabilities in WP Forum (WordPress Plugin)</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2010-12-17T00:00:00-08:00" pubdate data-updated="true">Dec 17<span>th</span>, 2010</time>
        
      </p>
    
  </header>


  <div class="entry-content"><h1 id="section"></h1>

<h1 id="multiple-vulnerabilities-in-wp-forum-wordpress-plugin">Multiple Vulnerabilities in WP Forum (WordPress Plugin)</h1>

<h2 id="advisory-information">1. Advisory Information</h2>

<p>Title: Multiple Vulnerabilities in WP-Forum<br />
Advisory URL: http://www.charleshooper.net/blog/multiple-vulnerabilities-in-wp-forum-wordpress-plugin/<br />
Date Published: 12/17/2010<br />
Vendors Contacted: WordPress. Maintainer of plugin is unreachable.</p>

<h2 id="summary">2. Summary</h2>

<p>WP Forum is a plugin for the popular blog tool and publishing platform, WordPress.<br />
The author of WP Forum describes it as a “Simple discussion forum plugin” and<br />
“easy to use and administer.”</p>

<p>There exist multiple vulnerabilities in WP Forum. Basically, input validation is not<br />
performed at all resulting in SQL injection, stored XSS, and reflected XSS vulns.</p>

<p>Furthermore, the author wrote the plugin under the assumption that it would only be<br />
executed within the context of the WordPress administrative panel, thereby neglecting<br />
to perform proper authentication and authorization.</p>

<h2 id="vulnerability-information">3. Vulnerability Information</h2>

<p>Packages/Versions Affected: Probably all, but confirmed only on WP Forum 1.7.8</p>

<p>3a. Type:   SQL Injection [CWE-89]<br />
3a. Impact: Read application data, bypass protection mechanism,<br />
modify application data. There are multiple SQL injections present<br />
in WP Forum. The most prominent of which is the SQL injection present<br />
in the `group_login` functionality. Prior to logging in, an attacker<br />
can retrieve each group’s passwords due to the vulnerability listed<br />
below (3b).</p>

<p>3b. Type:   Plaintext Storage of a Password [CWE-256]<br />
3b. Impact: Password is easily retrieved from database</p>

<p>3c. Type:   XSS (Stored or Reflected) [CWE-79]<br />
3c. Impact: Execute unauthorized code or commands</p>

<p>3d. Type:   Auth Bypass via Direct Request [CWE-425]<br />
3d. Impact: Many or all of the administrative functions assume they are running<br />
in the context of the WordPress administrative section. As a result,<br />
they often do not check that the user is authenticated or authorized<br />
to perform a particular action. Example functionality includes adding<br />
or removing forum moderators and deleting forums. This vulnerability<br />
could lead to information exposure, privilege escalation, or data loss.</p>

<p>3e. Type:   Information Exposure Through Sent Data [CWE-201]<br />
3e. Impact: `sendmail.php` discloses users’ email addresses by accepting a user-<br />
provider “user” variable and returns a hidden  tag containing<br />
that user’s email address.</p>

<p>3f. Type:   External Control of Assumed-Immutable Web Parameter [CWE-472]<br />
3f. Impact: `sendmail.php` accepts user-provided input allowing it to be used as<br />
an email relay</p>

<h2 id="poc--technical-description">4. PoC &amp; Technical Description</h2>

<p>Due to the number of vulnerabilities in this package, I will not discuss each one<br />
individually. Instead, here are some sample POCs. Many more exploitable vulns exist<br />
in this package than what I am providing here.</p>

<p>4a. http://path.to/wordpress/?page_id=&amp;forumaction=group_login&amp;group_id=0 UNION SELECT CONCAT_WS(CHAR(58),user_login,user_pass,user_email) FROM wp_users LIMIT 1 #<br />
or (goes for all POCs): http://path.to/wordpress/?forumaction=group_login&amp;group_id=0 UNION SELECT CONCAT_WS(CHAR(58),user_login,user_pass,user_email) FROM wp_users LIMIT 1 #<br />
4b. N/A<br />
4c. http://path.to/wordpress/?forumaction=group_login&amp;group_id=alert(document.cookie);<br />
4d. http://path.to/wordpress/wp-content/plugins/wpforum/wp-forum-manage.php?editgroupsubmit=true&amp;group=&amp;groupname=&amp;passwd=<br />
4e. http://path.to/wordpress/wp-content/plugins/wpforum/sendmail.php?user= (email address will be in HTML source)<br />
4f. POST ‘submit=true&amp;sender=&amp;email=&amp;message=&amp;subject=&amp;replyto=<br />
to http://path.to/wordpress/wp-content/plugins/wpforum/sendmail.php (untested)</p>

<h2 id="report-timeline">5. Report Timeline</h2>

<p>12/10/2010 Initial email sent to WordPress security.<br />
12/10/2010 Maintainer not yet contacted as project appears abandoned and maintainer<br />
does not have listed contact information.<br />
12/17/2010 No reply from WordPress security. Advisory released.</p>

<h2 id="references">6. References</h2>

<p>6a. The WordPress Plugin page for WP Forum:</p>

<p>http://wordpress.org/extend/plugins/wpforum/</p>

<p>6b. The WordPress Profile page for the author of the plugin:</p>

<p>http://profiles.wordpress.org/users/fahlstad/</p>

<p>6c. The plugin author’s website:</p>

<p>http://www.fahlstad.se/</p>

<h2 id="legalese">7. Legalese</h2>

<p>This vulnerability report by Charles Hooper &lt; chooper@plumata.com &gt; is<br />
licensed under a Creative Commons Attribution-NonCommercial-ShareAlike<br />
3.0 Unported License.</p>

<h2 id="signature">8. Signature</h2>

<p>Public Key: Obtainable via pool.sks-keyservers.net</p>
</div>
  
  


    </article>
  
  <div class="pagination">
    
      <a class="prev" href="/blog/page/5/">&larr; Older</a>
    
    <a href="/blog/archives">Blog Archives</a>
    
    <a class="next" href="/blog/page/3/">Newer &rarr;</a>
    
  </div>
</div>
<aside class="sidebar">
  
    <section>
  <!-- Ads removed -->
</section>
<section>
  <h1>About Charles</h1>
	<img src="http://www.gravatar.com/avatar/9f645d339b731bc99a95704ad4289aac.png?size=160" alt="Charles Hooper"/>
	<p>Charles is an engineering manager at Heroku. He enjoys archery, smoking meat, gardening, home brewing, and hacking.</p>
</section>
<section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/what-am-i-supposed-to-do-with-all-of-this-honey/">What am I supposed to do with all of this honey?!</a>
      </li>
    
      <li class="post">
        <a href="/blog/give-it-a-rest/">Give it a rest</a>
      </li>
    
      <li class="post">
        <a href="/blog/on-slack-and-upkeep/">On Slack and Upkeep</a>
      </li>
    
      <li class="post">
        <a href="/blog/what-i-do-sre/">What I Do as an SRE</a>
      </li>
    
      <li class="post">
        <a href="/blog/troubleshooting-elbs-with-elbping/">Troubleshooting ELBs with elbping</a>
      </li>
    
  </ul>
</section>

<section>
  <!-- Ads removed -->
</section>

  
</aside>

    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2015 - Charles Hooper -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  

<script type="text/javascript">
      var disqus_shortname = 'charleshooper';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'http://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>







  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = 'http://platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
